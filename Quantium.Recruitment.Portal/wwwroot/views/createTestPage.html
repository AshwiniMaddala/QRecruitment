<md-toolbar>
    <div class="md-toolbar-tools">
        <md-button hide-gt-sm class="md-icon-button">
            <md-icon md-svg-icon="menu"></md-icon>
        </md-button>
        <h1>
            Create test
        </h1>
    </div>
</md-toolbar>
<md-content>
    <form name="createTestForm">
        <md-card>
            <md-card-content layout="column">
                <div layout="row">
                    <md-input-container flex-gt-sm="30">
                        <label>Job</label>
                        <md-select ng-model="selectedJobId" required name="selectedJobName">
                            <md-option value="0"><em>None</em></md-option>
                            <md-option ng-repeat="job in jobs" ng-value="job.Id" ng-click="changeSelectedJob(job)">
                                {{job.Title}}
                            </md-option>
                        </md-select>
                        <div ng-messages="createTestForm.selectedJobName.$error">
                            <div ng-message="required">Job is required.</div>
                        </div>
                    </md-input-container>
                </div>
                <div ng-hide="selectedJobId == 0">
                    <div layout="row">
                        <div flex-gt-sm="35">
                            <h4 ng-show="totalQuestionsInSelectedJob">Total questions in selected job: {{totalQuestionsInSelectedJob}}</h4>
                            <h4 ng-show="totalCorrectAnswersInSelectedJob">Total right answers to pass the test: {{totalCorrectAnswersInSelectedJob}}</h4>
                        </div>
                        <div flex-gt-sm="50">
                            <div>
                                <div ng-repeat="jobDifficultyLabel in selectedJob.JobDifficultyLabels">
                                    <md-chips>
                                        <md-chip>{{jobDifficultyLabel.Label.Name}}</md-chip>
                                        <md-chip>Difficulty - {{jobDifficultyLabel.Difficulty.Name}}</md-chip>
                                        <md-chip>Questions - {{jobDifficultyLabel.DisplayQuestionCount}}</md-chip>
                                        <md-chip>Passing criteria - {{jobDifficultyLabel.PassingQuestionCount}}</md-chip>
                                    </md-chips>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </md-card-content>
        </md-card>

        <md-card>
            <md-card-content>
                <h3 class="fileUpload">Select the candidates for this job</h3>
                <div layout="row" layout-wrap>
                    <div ng-repeat="candidate in candidates">
                        <md-card>
                            <md-card-content>
                                <md-input-container>
                                    <md-checkbox ng-model="selectedtestOptions.candidateIds[candidate.Id]">
                                        {{candidate.FirstName}} {{candidate.LastName}}
                                    </md-checkbox>
                                    <h4>{{candidate.Email}}</h4>
                                </md-input-container>
                            </md-card-content>
                        </md-card>
                    </div>
                </div>

                <br />
                <br />
                <br />
                <md-button ng-disabled="!hasSelectedAtleastOneCandidate" type="submit" class="md-primary md-raised" ng-click="createTestForm.$valid && generateTest()">
                    Generate test for selected candidates
                </md-button>
                <!--<div class="_md-right" ng-show="testGenerationResult">
                    <md-button class="md-primary md-raised" ng-click="sendTest()">
                        Send test for selected candidates
                    </md-button>
                </div>-->
            </md-card-content>
        </md-card>
    </form>
</md-content>

<div style="visibility: hidden">
    <div class="md-dialog-container" id="uploadStatusModal">
        <md-dialog>
            <md-toolbar class="md-accent">
                <div class="md-toolbar-tools">
                    <h3>
                        Job creation in progress
                    </h3>
                </div>
            </md-toolbar>
            <md-content>
                <md-card>
                    <md-card-content>
                        <div layout="row" layout-align="space-around">
                            <md-progress-circular md-mode="indeterminate" class="md-primary"></md-progress-circular>
                        </div>
                    </md-card-content>
                </md-card>

            </md-content>
        </md-dialog>
    </div>
</div>